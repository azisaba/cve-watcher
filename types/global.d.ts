export {}

declare global {
  type CVEsAPIResponse = {
    resultsPerPage: number
    startIndex: number
    totalResults: number
    result: CVEResponseData
  }

  type CVEResponseData = {
    CVE_data_type: string
    CVE_data_format: string
    CVE_data_version: string
    CVE_data_numberOfCVEs: string
    CVE_data_timestamp: string
    CVE_Items: CVEEntry[]
  }

  type CVEEntry = {
    cve: CVEData
    configurations: CVEConfigurations
    impact: CVEImpact
    publishedDate: string
    lastModifiedDate: string
  }

  type CVEData = {
    data_type: string
    data_format: string
    data_version: string
    CVE_data_meta: CVEDataMeta
    problemtype: CVEProblemType
    references: CVEReferences
    description: CVEDescription
  }

  type CVEDataMeta = {
    ID: string
    ASSIGNER: string
  }

  type CVEConfigurations = {
    CVE_data_version: string
    nodes: any[]
  }

  type CVEImpact = {
    baseMetricV3?: CVEBaseMetricV3
    baseMetricV2?: CVEBaseMetricV2
  }

  type CVEBaseMetricV3 = {
    cvssV3: CVECvssV3
    exploitabilityScore: number
    impactScore: number
  }

  type CVECvssV3 = {
    version: string
    vectorString: string
    attackVector: 'NETWORK' | 'ADJACENT_NETWORK' | 'LOCAL' | 'PHYSICAL'
    attackComplexity: 'LOW' | 'HIGH'
    privilegesRequired: 'NONE' | 'LOW' | 'HIGH'
    userInteraction: 'NONE' | 'REQUIRED'
    scope: 'UNCHANGED' | 'CHANGED'
    confidentialityImpact: 'NONE' | 'LOW' | 'HIGH'
    integrityImpact: 'NONE' | 'LOW' | 'HIGH'
    availabilityImpact: 'NONE' | 'LOW' | 'HIGH'
    baseScore: number
    baseSeverity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL'
  }

  type CVEBaseMetricV2 = {
    cvssV2: CVECvssV2
    severity: string
    exploitabilityScore: number
    impactScore: number
    acInsufInfo: boolean
    obtainAllPrivilege: boolean
    obtainUserPrivilege: boolean
    obtainOtherPrivilege: boolean
    userInteractionRequired: boolean
  }

  type CVECvssV2 = {
    version: string
    vectorString: string
    accessVector: 'NETWORK' | 'ADJACENT_NETWORK' | 'LOCAL' | 'PHYSICAL'
    accessComplexity: 'LOW' | 'MEDIUM' | 'HIGH'
    authentication: 'NONE' | 'SINGLE_INSTANCE' | 'MULTIPLE_INSTANCES'
    confidentialityImpact: string
    integrityImpact: string
    availabilityImpact: string
    baseScore: number
  }

  type CVEProblemType = {
    problemtype_data: CVEProblemTypeData[]
  }

  type CVEProblemTypeData = {
    description: any[]
  }

  type CVEReferences = {
    reference_data: CVEReferenceData[]
  }

  type CVEReferenceData = {
    url: string
    name: string
    refsource: string
    tags: string[]
  }

  type CVEDescription = {
    description_data: CVEDescriptionData[]
  }

  type CVEDescriptionData = {
    value: string
    lang: string
  }
}
